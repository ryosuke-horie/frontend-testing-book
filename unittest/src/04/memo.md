# モックを使用する目的

テストは実際の実行環境と同じ状況に近づけることでより忠実だが、大変だったりそもそも無理だったりする。
特にAPIとかを利用する場合。

テストする対象は「取得したデータに対応する処理」であることがほとんどであるからAPIサーバーは必ずしも必要ではない。
代用品として「モック（テストダブル）」が存在する。

## モックの用語整理

「スタブ」「スパイ」とはモックを分類した名前。
### スタブの目的
「代用」することが目的

- 依存コンポーネントの代用品
- 定められた値を返却する
- テスト対象に「入力」を与えるためのもの

例えばWeb Apiに依存しているテスト対象の検証。
Web APIがこんな値を返して来たらこう動作する、というテストでスタブを使用。

### スパイの目的
「記録」

- 関数やメソッドの呼び出しを記録するオブジェクト
- 呼び出された回数、実行時引数を記録するもの
- テスト対象からの出力を確認するためのもの

スパイはテスト対象から外側へ向けた出力の検証。

例えば関数引数のコールバック関数。
実行された回数、実行時引数を記録するので意図した呼び出しを行ったか確認できる。

## モックモジュールを使ったスタブ
都合の悪いモジュールを代用品に置き換えることでテスト不能だった対象のテストが実施できるようになる。

実践でモックモジュールを最も利用するのはライブラリの代用。

1つのテスト対象に対して異なる代用品へアクセスさせたい場合、サンプルと同じようにテストファイルを別熱に用意するべき。

importを適用する方法はほかにもある。